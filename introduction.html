<!DOCTYPE html>
<html class="no-js" lang="en">

<head>
<title>Introduction · Akka Streams Checkpoint</title>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<meta name="description" content='Checkpoint stage to monitor Akka Streams streaming applications'/>
<link href="https://fonts.googleapis.com/css?family=Roboto:100normal,100italic,300normal,300italic,400normal,400italic,500normal,500italic,700normal,700italic,900normal,900italicc" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="lib/jquery/jquery.min.js"></script>
<script type="text/javascript" src="js/page.js"></script>
<script type="text/javascript" src="js/groups.js"></script>
<link rel="stylesheet" type="text/css" href="lib/normalize.css/normalize.css"/>
<link rel="stylesheet" type="text/css" href="lib/foundation/dist/foundation.min.css"/>
<link rel="stylesheet" type="text/css" href="css/page.css"/>

<!--
<link rel="shortcut icon" href="images/favicon.ico" />
-->
</head>

<body>
<div class="off-canvas-wrapper">
<div class="off-canvas-wrapper-inner" data-off-canvas-wrapper>

<div class="off-canvas position-left" id="off-canvas-menu" data-off-canvas>
<nav class="off-canvas-nav">
<div class="nav-home">
<a href="index.html" >
<span class="home-icon">⌂</span>Akka Streams Checkpoint
</a>
<div class="version-number">
0.0.2
</div>
</div>
<div class="nav-toc">
<ul>
  <li><a href="introduction.html" class="active page">Introduction</a></li>
  <li><a href="gettingStarted.html" class="page">Getting started</a></li>
  <li><a href="backends.html" class="page">Backends</a></li>
  <li><a href="demo.html" class="page">Demo</a></li>
</ul>
</div>

</nav>
</div>

<div class="off-canvas-content" data-off-canvas-content>

<header class="site-header expanded row">
<div class="small-12 column">
<a href="#" class="off-canvas-toggle hide-for-medium" data-toggle="off-canvas-menu"><svg class="svg-icon svg-icon-menu" version="1.1" id="Menu" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 20 20" enable-background="new 0 0 20 20" xml:space="preserve"> <path class="svg-icon-menu-path" fill="#53CDEC" d="M16.4,9H3.6C3.048,9,3,9.447,3,10c0,0.553,0.048,1,0.6,1H16.4c0.552,0,0.6-0.447,0.6-1C17,9.447,16.952,9,16.4,9z M16.4,13
H3.6C3.048,13,3,13.447,3,14c0,0.553,0.048,1,0.6,1H16.4c0.552,0,0.6-0.447,0.6-1C17,13.447,16.952,13,16.4,13z M3.6,7H16.4
C16.952,7,17,6.553,17,6c0-0.553-0.048-1-0.6-1H3.6C3.048,5,3,5.447,3,6C3,6.553,3.048,7,3.6,7z"/></svg>
</a>
<div class="title"><a href="index.html">Akka Streams Checkpoint</a></div>

<!--
<a href="https://www.example.com" class="logo show-for-medium">logo</a>
-->
</div>
</header>

<div class="expanded row">

<div class="medium-3 large-2 show-for-medium column">
<nav class="site-nav">
<div class="nav-home">
<a href="index.html" >
<span class="home-icon">⌂</span>Akka Streams Checkpoint
</a>
<div class="version-number">
0.0.2
</div>
</div>
<div class="nav-toc">
<ul>
  <li><a href="introduction.html" class="active page">Introduction</a></li>
  <li><a href="gettingStarted.html" class="page">Getting started</a></li>
  <li><a href="backends.html" class="page">Backends</a></li>
  <li><a href="demo.html" class="page">Demo</a></li>
</ul>
</div>

</nav>
</div>

<div class="small-12 medium-9 large-10 column">
<section class="site-content">

<div class="page-header row">
<div class="medium-12 show-for-medium column">
<div class="nav-breadcrumbs">
<ul>
  <li><a href="index.html">Akka Streams Checkpoint</a></li>
  <li>Introduction</li>
</ul>
</div>
</div>
</div>

<div class="page-content row">
<div class="small-12 large-9 column" id="docs">
<h1><a href="#introduction" name="introduction" class="anchor"><span class="anchor-link"></span></a>Introduction</h1>
<h2><a href="#motivation" name="motivation" class="anchor"><span class="anchor-link"></span></a>Motivation</h2>
<p><a href="http://www.reactive-streams.org/">Reactive Streams</a> are the key to build asynchronous, data-intensive applications with no predetermined data volumes. By enabling non-blocking backpressure, they boost the resiliency of your systems by design. <a href="http://doc.akka.io/docs/akka/2.5.12/scala/stream/index.html">Akka Streams</a> is a widely used toolkit that internally implements the Reactive Streams JVM specification, whilst offering a much more user-friendly API.</p>
<p>But how do you tune and debug such applications? Two main challenges make monitoring Akka Streams application very different (and somehow trickier) then traditional applications.</p>
<ol>
  <li>
  <p><strong>non-linearity</strong>: Akka Streams stages are not functions. Each stage&rsquo;s inputs and outputs are uncorrelated: zero/one input can produce multiple (potentially infinite) outputs. Conversely, multiple inputs can produce fewer (potentially zero) outputs. This makes measuring key metrics such as throughput and latency more challenging, as there is no generic way to determine when an event has been processed.</p></li>
  <li>
  <p><strong>backpressure</strong>: Akka Streams stages are backpressure-enabled. This means that, in a multi-stage pipeline, the slower stage will determine the throughput of the whole pipeline. This is the whole point of Reactive Streams, allowing your pipeline to go &ldquo;as fast as possible, but not faster&rdquo;. However, this gets in the way of effectively looking for bottlenecks, as there is no clear way of understanding what is backpressuring and what&rsquo;s not.</p></li>
</ol>
<p>Whilst Akka Streams doesn&rsquo;t currently provide a comprehensive solution to these issues, it exposes a low-level API that allows to perform custom actions when <em>push</em> and <em>pull</em> signals are sent to a stage. This library leverages this API. For more details on this, check out <a href="http://doc.akka.io/docs/akka/2.5.12/stream/stream-customize.html">this section</a> of the Akka Streams documentation.</p>
<h2><a href="#what-this-library-does" name="what-this-library-does" class="anchor"><span class="anchor-link"></span></a>What this library does</h2>
<p><em>Akka Streams Checkpoint</em> attempts to overcome the two challenges above. It allows to create generic, pass-through stages that can be placed at meaningful points in your pipeline. </p>
<h3><a href="#throughput" name="throughput" class="anchor"><span class="anchor-link"></span></a>Throughput</h3>
<p>Throughput is the measurement of how many events are processed by your pipeline in a unit of time. Because of non-linearity, measuring the throughput of a whole pipeline might not necessarily be helpful. Each section of your pipeline can have a different throughput, and it is up to the developer to determine what&rsquo;s meaningful and what&rsquo;s not.</p>
<p>A <em>checkpoint</em> placed in a pipeline will be notified each time an element is pushed out of it, allowing the backend to record the event accordingly.</p><div class="callout note "><div class="callout-title">Note</div>
<p>Throughputs can also be aggregated to record &ldquo;relative&rdquo; throughputs. A ratio between throughputs measured at two different points in your pipeline will give you an idea of how many events are dropped/conflated (if the ratio is lower than 100%) or how many are generated/expanded (if the ratio is higher than 100%). Dashboard tools like <a href="https://grafana.com/">Grafana</a> and <a href="https://www.datadoghq.com/">Datadog</a> allow to compose series.</p></div>
<h3><a href="#pull-push-and-push-pull-latency" name="pull-push-and-push-pull-latency" class="anchor"><span class="anchor-link"></span></a>Pull-push and push-pull latency</h3>
<p>Each <em>checkpoint</em> is a linear stage that emits downstream all the elements which are pushed from upstream. This means that for each pull from downstream, there will be a push from upstream. Latency is being measured:</p>
<ul>
  <li><em>between a push and the last pull</em>: this will give us a reading of how much time the upstream takes to produce an element after it&rsquo;s been requested</li>
  <li><em>between a pull and the last push</em>: this will give us a reading of how time the downstream takes to request an element after the previous element has been emitted</li>
</ul>
<h3><a href="#backpressure-ratio" name="backpressure-ratio" class="anchor"><span class="anchor-link"></span></a>Backpressure ratio</h3>
<p>A <em>checkpoint</em> can be in one of two working states:</p>
<ul>
  <li><em>backpressuring</em>: the checkpoint is waiting for a pull from the downstream</li>
  <li><em>NOT backpressuring</em>: the checkpoint is waiting for a push from the upstream</li>
</ul>
<p>The <em>backpressure ratio</em> metric measures the percentage of time spent by the checkpoint in the backpressuring state. A high backpressure ratio indicates that a bottleneck is present downstream of the checkpoint.</p>
<h3><a href="#liveness" name="liveness" class="anchor"><span class="anchor-link"></span></a>Liveness</h3>
<p>Backpressured systems can suffer from liveness issues. These can have a variety of causes, ranging from an unresponsive third party, all the way to <a href="http://doc.akka.io/docs/akka/2.5.12/stream/stream-graphs.html#graph-cycles-liveness-and-deadlocks">code bugs</a>. In case of a liveness issue, no demand will flow from downstream to upstream. This will cause all the metrics previously described to fall silent. To solve this issue, each <em>checkpoint</em> keeps a basic flag counter that represents if the <em>checkpoint</em> is currently backpressured. Because of its simplicity, this metric becomes meaningful in case of liveness issues.</p>
<h2><a href="#what-this-library-does-not" name="what-this-library-does-not" class="anchor"><span class="anchor-link"></span></a>What this library does NOT</h2>
<h3><a href="#error-tracking" name="error-tracking" class="anchor"><span class="anchor-link"></span></a> Error tracking</h3>
<p><em>Akka Streams Checkpoint</em> does not currently offer a way to record errors or completion events happening in the pipeline. Check out <a href="http://doc.akka.io/docs/akka/2.5.12/stream/operators/index.html#watching-status-stages">these stages</a> already provided by Akka Streams for these purposes.</p>
<h3><a href="#trace-context" name="trace-context" class="anchor"><span class="anchor-link"></span></a>Trace context</h3>
<p><em>Akka Streams Checkpoint</em> is not a solution to allow tracing of context in Akka Streams applications. However, the checkpoints provided by this library are completely transparent and should be able to coexist with any pipeline model, including trace context.</p>
<div class="source-github">
The source code for this page can be found <a href="https://github.com/svezfaz/akka-stream-checkpoint/tree/master/docs/src/main/paradox/introduction.md">here</a>.
</div>

<div class="nav-next">
<p><strong>Next:</strong> <a href="gettingStarted.html">Getting started</a></p>
</div>
</div>
<div class="large-3 show-for-large column" data-sticky-container>
<nav class="sidebar sticky" data-sticky data-anchor="docs" data-sticky-on="large">
<div class="page-nav">
<div class="nav-title">On this page:</div>
<div class="nav-toc">
<ul>
  <li><a href="introduction.html#introduction" class="header">Introduction</a>
  <ul>
    <li><a href="introduction.html#motivation" class="header">Motivation</a></li>
    <li><a href="introduction.html#what-this-library-does" class="header">What this library does</a>
    <ul>
      <li><a href="introduction.html#throughput" class="header">Throughput</a></li>
      <li><a href="introduction.html#pull-push-and-push-pull-latency" class="header">Pull-push and push-pull latency</a></li>
      <li><a href="introduction.html#backpressure-ratio" class="header">Backpressure ratio</a></li>
      <li><a href="introduction.html#liveness" class="header">Liveness</a></li>
    </ul></li>
    <li><a href="introduction.html#what-this-library-does-not" class="header">What this library does NOT</a>
    <ul>
      <li><a href="introduction.html#error-tracking" class="header"> Error tracking</a></li>
      <li><a href="introduction.html#trace-context" class="header">Trace context</a></li>
    </ul></li>
  </ul></li>
</ul>
</div>
</div>
</nav>
</div>
</div>

</section>
</div>

</div>

<footer class="site-footer">

<section class="site-footer-nav">
<div class="expanded row">
<div class="small-12 large-offset-2 large-10 column">
<div class="row site-footer-content">

<div class="small-12 medium-4 large-3 text-center column">
<div class="nav-links">
<ul>
<!-- <li><a href="https://www.example.com/products/">Products</a> -->
</ul>
</div>
</div>

</div>
</div>
</div>
</section>

<section class="site-footer-base">
<div class="expanded row">
<div class="small-12 large-offset-2 large-10 column">
<div class="row site-footer-content">

<div class="small-12 text-center large-9 column">

<!--
<div class="copyright">
<span class="text">&copy; 2018</span>
<a href="https://www.example.com" class="logo">logo</a>
</div>
-->
</div>

</div>
</div>
</div>
</section>
</footer>

</div>
</div>
</div>
</body>

<script type="text/javascript" src="lib/foundation/dist/foundation.min.js"></script>
<script type="text/javascript">jQuery(document).foundation();</script>
<script type="text/javascript" src="js/magellan.js"></script>

<style type="text/css">@import "lib/prettify/prettify.css";</style>
<script type="text/javascript" src="lib/prettify/prettify.js"></script>
<script type="text/javascript" src="lib/prettify/lang-scala.js"></script>
<script type="text/javascript">jQuery(function(){window.prettyPrint && prettyPrint()});</script>

</html>
